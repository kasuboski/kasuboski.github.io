<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Deploying this site with GitHub Actions | Josh Kasuboski</title><meta name=description content="This site is built with Hugo and deployed to GitHub Pages using GitHub Actions"><meta name=author content><link rel=apple-touch-icon sizes=180x180 href=https://www.joshkasuboski.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://www.joshkasuboski.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://www.joshkasuboski.com/favicon-16x16.png><link rel=manifest href=https://www.joshkasuboski.com/site.webmanifest><link rel=mask-icon href=https://www.joshkasuboski.com/safari-pinned-tab.svg color=#00416a><meta name=msapplication-TileColor content="#00aba9"><meta name=theme-color content="#ffffff"><link rel=me href=mailto:josh.kasuboski@gmail.com><link rel=me href=https://github.com/kasuboski><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=microsub href=https://aperture.p3k.io/microsub/465><link rel=alternate type=application/rss+xml href=https://www.joshkasuboski.com/index.xml><link rel=stylesheet href=https://www.joshkasuboski.com/css/fonts.css><link rel=stylesheet href=https://www.joshkasuboski.com/css/style.css><meta name=viewport content="width=device-width,initial-scale=1"></head><body><div id=sitelogo><a class=glyph alt=Home href=https://www.joshkasuboski.com/><img src=https://www.joshkasuboski.com/images/site-logo.svg alt="Site Logo" height=64px width=64px></a></div><header><nav><div id=page-nav><div class=page-nav-item><a href=https://www.joshkasuboski.com/>Home</a></div><div class=page-nav-item><a href=/about/><span>About</span></a></div><div class=page-nav-item><a href=/now/><span>Now</span></a></div></div></nav></header><div id=content><article class=h-entry><header><h1 class="post-title p-name">Deploying this site with GitHub Actions</h1><p class=post-date>Posted on
<time class=dt-published datetime=2020-04-05T16:18:12-05:00>5 April, 2020 at 16:18 -0500</time> by <a href=https://www.joshkasuboski.com/ class="p-author h-card" rel=author>Josh</a></p></header><section class="content e-content"><p><a href=https://pages.github.com/>GitHub pages</a> is a free static hosting provider that unsurprisingly works well with a git workflow. It enables <code>git push</code> to deploy type workflows. This site itself is a static site built with <a href=https://gohugo.io/>hugo</a> and deployed to GitHub Pages using GitHub Actions.</p><h2 id=github-pages-repo>GitHub Pages Repo</h2><p>GitHub Pages expects that you have a repo named something like <code>user.github.io</code> that has static files you want deployed. However, if your site requires any sort of building this doesn't really work for you (at least if you want to automate the build step).</p><p>One way around this is to treat your GitHub Pages Repo as the output for your build. You create a separate repo that just has the built static files. You can see the repo for this site at <a href=https://github.com/kasuboski/kasuboski.github.io>kasuboski/kasuboski.github.io</a>.</p><p>You'll notice it just has static html, css, etc. I write the content for this site in markdown however, using Hugo.</p><h2 id=code-repo>Code Repo</h2><p>The actual content is stored in a separate repo that I'm referring to as the code repo. The repo for this site is <a href=https://github.com/kasuboski/personal-site>kasuboski/personal-site</a>. This repo should look a little more familiar to anyone who has used Hugo.</p><p>The content is under <code>content/posts</code> and is written in markdown. This is the repo that I actually modify and have checked out locally. If I wanted to create a new release of it manually I would build the site and push it to the GitHub Pages Repo with the commands below.</p><pre><code>hugo --minify
cp ./public ../kasuboski.github.io/
cd ../kasuboski.github.io
git commit -am &quot;cool new post&quot;
git push origin master
</code></pre><h2 id=automatic-deploy-with-github-actions>Automatic Deploy with GitHub Actions</h2><p>I don't really want to mess with multiple repositories locally, especially when one of them is essentially machine generated. GitHub Actions can build the site with Hugo and then push it to the GitHub Pages Repo for me.</p><p>The workflow file for this can be found <a href=https://github.com/kasuboski/personal-site/blob/master/.github/workflows/gh-pages.yaml>here</a> if you just want to copy it.</p><p>The basic steps are: check out the code repo, build the site with hugo, push the files to the GitHub Pages Repo, and notify me of the status using <a href=https://pushover.net>Pushover</a>.</p><p>It relies heavily on already available actions. The only prerequisite setup is to make a deploy key for the GitHub Pages Repo and to register an app with Pushover.</p><p>You can find a walkthrough of creating a deploy key <a href=https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-create-ssh-deploy-key>here</a>.</p><p>Configuring a Pushover app is <a href=https://pushover.net/apps/build>here</a>. You'll need the app token and user token. I added both as secrets on the Code Repo.</p><p>Now anytime I push a change to the code repo, GitHub Actions will generate the files, update the GitHub Pages repo and send me a push notification with the status.</p></section><footer><a class="permalink u-url" href=https://www.joshkasuboski.com/posts/deploy-site-github-actions/>ðŸ”—</a></footer></article></div><div class=h-card><img class=u-photo src=https://www.joshkasuboski.com/img/josh-scotland.jpg><div class=card-content><h2 class=card-name><a class="p-name u-url" href=https://www.joshkasuboski.com/ rel=me>Josh Kasuboski</a></h2><p class=card-subhead><span class=p-locality>Austin</span>,
<span class=p-country-name>United States</span><br><a class=u-email href=mailto:josh.kasuboski@gmail.com>Email me</a></p></div><p class=p-note>Josh Kasuboski is currently interested in developer productivity. He works to make it easier for a developer to take code from laptop to production.</p></div><div id=footer><nav id=article-skip><div class=next><p>&nbsp;</p></div><div class=top><a alt="Top of page" href=#>Top</a></div><div class=prev><a alt="Older article" href=https://www.joshkasuboski.com/posts/dark-sky-shutdown/>Older &rarr;</a></div></nav><aside id=social><div id=social-icons><div class=icon-24x24><a class=glyph alt="Email me" href=mailto:josh.kasuboski@gmail.com><img src=https://www.joshkasuboski.com/icons/envelope.svg height=24px width=24px></a></div><div class=icon-24x24><a class=glyph alt="GitHub profile" href=https://github.com/kasuboski><img src=https://www.joshkasuboski.com/icons/github.svg height=24px width=24px></a></div><div class=icon-24x24><a class=glyph alt="LinkedIn profile" href=https://www.linkedin.com/in/joshkasuboski><img src=https://www.joshkasuboski.com/icons/linkedin.svg height=24px width=24px></a></div></div></aside><p class=copyright>Copyright Â© 2020, Josh Kasuboski</p></div></body></html>