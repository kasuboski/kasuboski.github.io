<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Deploying this site with GitHub Actions | Josh Kasuboski</title><meta name=description content="This site is built with Hugo and deployed to GitHub Pages using GitHub Actions"><meta name=author content><link rel=me href=mailto:josh.kasuboski@gmail.com><link rel=me href=https://github.com/kasuboski><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=microsub href=https://aperture.p3k.io/microsub/465><link rel=alternate type=application/rss+xml href=https://www.joshkasuboski.com/index.xml><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://unpkg.com/turretcss/dist/turretcss.min.css crossorigin=anonymous><style>@media only screen and (min-width:768px){:root{font-size:18px}}body{background-color:#faf9fa}pre{background-color:#d4f2e1}a{text-decoration-color:#5965f9}#site-header{box-shadow:0 4px 12px 0 rgba(0,0,0,.05)}#intro{background-color:#e6e8fe}#social a{color:transparent;text-decoration:none}</style></head><body><div class=padding-bottom-s><header id=site-header><div class="container max-width-l flex-justify-center padding-vertical-xs"><h1 class=no-margin-bottom><a class="text-decoration-none flex align-items-center" href=https://www.joshkasuboski.com/><img class="icon-s margin-right-xs" src=https://www.joshkasuboski.com/images/jk-logo.svg><small>Josh Kasuboski</small></a></h1><nav class=nav-inline><ul><li><a href=/about/>About</a></li><li><a href=/now/>Now</a></li></ul></nav></div></header><main class="container max-width-l margin-top-l"><article class=h-entry><header><h1 class="display-title-xl no-margin-bottom post-title p-name">Deploying this site with GitHub Actions</h1><p class="post-date no-margin-top">Posted on
<time class=dt-published datetime=2020-04-05T16:18:12-05:00>5 April, 2020</time> by <a href=https://www.joshkasuboski.com/ class="p-author h-card" rel=author>Josh</a></p></header><section class="content e-content margin-top-l"><p><a href=https://pages.github.com/>GitHub pages</a> is a free static hosting provider that unsurprisingly works well with a git workflow. It enables <code>git push</code> to deploy type workflows. This site itself is a static site built with <a href=https://gohugo.io/>hugo</a> and deployed to GitHub Pages using GitHub Actions.</p><h2 id=github-pages-repo>GitHub Pages Repo</h2><p>GitHub Pages expects that you have a repo named something like <code>user.github.io</code> that has static files you want deployed. However, if your site requires any sort of building this doesn't really work for you (at least if you want to automate the build step).</p><p>One way around this is to treat your GitHub Pages Repo as the output for your build. You create a separate repo that just has the built static files. You can see the repo for this site at <a href=https://github.com/kasuboski/kasuboski.github.io>kasuboski/kasuboski.github.io</a>.</p><p>You'll notice it just has static html, css, etc. I write the content for this site in markdown however, using Hugo.</p><h2 id=code-repo>Code Repo</h2><p>The actual content is stored in a separate repo that I'm referring to as the code repo. The repo for this site is <a href=https://github.com/kasuboski/personal-site>kasuboski/personal-site</a>. This repo should look a little more familiar to anyone who has used Hugo.</p><p>The content is under <code>content/posts</code> and is written in markdown. This is the repo that I actually modify and have checked out locally. If I wanted to create a new release of it manually I would build the site and push it to the GitHub Pages Repo with the commands below.</p><pre><code>hugo --minify
cp ./public ../kasuboski.github.io/
cd ../kasuboski.github.io
git commit -am &quot;cool new post&quot;
git push origin master
</code></pre><h2 id=automatic-deploy-with-github-actions>Automatic Deploy with GitHub Actions</h2><p>I don't really want to mess with multiple repositories locally, especially when one of them is essentially machine generated. GitHub Actions can build the site with Hugo and then push it to the GitHub Pages Repo for me.</p><p>The workflow file for this can be found <a href=https://github.com/kasuboski/personal-site/blob/master/.github/workflows/gh-pages.yaml>here</a> if you just want to copy it.</p><p>The basic steps are: check out the code repo, build the site with hugo, push the files to the GitHub Pages Repo, and notify me of the status using <a href=https://pushover.net>Pushover</a>.</p><p>It relies heavily on already available actions. The only prerequisite setup is to make a deploy key for the GitHub Pages Repo and to register an app with Pushover.</p><p>You can find a walkthrough of creating a deploy key <a href=https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-create-ssh-deploy-key>here</a>.</p><p>Configuring a Pushover app is <a href=https://pushover.net/apps/build>here</a>. You'll need the app token and user token. I added both as secrets on the Code Repo.</p><p>Now anytime I push a change to the code repo, GitHub Actions will generate the files, update the GitHub Pages repo and send me a push notification with the status.</p></section><footer class=margin-top-m><a class="permalink u-url text-decoration-none" href=https://www.joshkasuboski.com/posts/deploy-site-github-actions/>ðŸ”—</a></footer></article><nav class="margin-top-l flex justify-content-space-around"><div><a alt="Newer article" href=https://www.joshkasuboski.com/posts/home-k8s-raspberry-pi/>&larr; Homelab Raspberry Pi Kubernetes Cluster</a></div><div class=show-s-up><a alt="Top of page" href=#>Top</a></div><div><a alt="Older article" href=https://www.joshkasuboski.com/posts/dark-sky-shutdown/>Weather Data after Dark Sky Shutdown &rarr;</a></div></nav></main><footer class="container max-width-l margin-top-xl"><div class="box-shadow-l padding-m"><div class="h-card flex align-content-center"><figure class=icon-xxl><img class=u-photo src=https://www.joshkasuboski.com/img/josh-scotland.jpg></figure><div class=margin-left-m><h3 class=display-title><a class="u-url p-name text-decoration-none" href=https://www.joshkasuboski.com/>Josh Kasuboski</a></h3><p>Living in Austin <img class=icon-xs alt=texas src=https://www.joshkasuboski.com/img/texas.png> from <img class=icon-xs alt=wisconsin src=https://www.joshkasuboski.com/img/wisconsin.png></p><p id=social><a rel=me class="u-url margin-right-xs" href=https://github.com/kasuboski><img class=icon-xs src=https://www.joshkasuboski.com/icons/github.svg></a>
<a class=margin-right-xs href=https://linkedin.com/kasuboski><img class=icon-xs src=https://www.joshkasuboski.com/icons/linkedin.svg></a>
<a href=mailto:josh.kasuboski@gmail.com class=u-email rel=me><img class=icon-xs src=https://www.joshkasuboski.com/icons/envelope.svg alt=email></a></p></div></div></div></footer></div></body></html>