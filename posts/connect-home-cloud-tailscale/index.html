<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Connect Your Home to the Cloud with Tailscale | Josh Kasuboski</title><meta name=description content="Josh Kasuboski's personal site"><meta name=author content><link rel=me href=mailto:josh.kasuboski@gmail.com><link rel=me href=https://github.com/kasuboski><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=microsub href=https://microsub.joshcorp.co/microsub><link rel=alternate type=application/rss+xml href=https://www.joshkasuboski.com/index.xml><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://unpkg.com/turretcss/dist/turretcss.min.css crossorigin=anonymous><style>@media only screen and (min-width:768px){:root{font-size:18px}}body{background-color:#faf9fa}pre{background-color:#d4f2e1}a{text-decoration-color:#5965f9}#site-header{box-shadow:0 4px 12px 0 rgba(0,0,0,.05)}#intro{background-color:#e6e8fe}#social a{color:transparent;text-decoration:none}</style></head><body><div class=padding-bottom-s><header id=site-header><div class="container max-width-l flex-justify-center padding-vertical-xs"><h1 class=no-margin-bottom><a class="text-decoration-none flex align-items-center" href=https://www.joshkasuboski.com/><img class="icon-s margin-right-xs" src=https://www.joshkasuboski.com/images/jk-logo.svg><small>Josh Kasuboski</small></a></h1><nav class=nav-inline><ul><li><a href=/about/>About</a></li><li><a href=/now/>Now</a></li></ul></nav></div></header><main class="container max-width-l margin-top-l"><article class=h-entry><header><h1 class="display-title-xl no-margin-bottom post-title p-name">Connect Your Home to the Cloud with Tailscale</h1><p class="post-date no-margin-top">Posted on
<time class=dt-published datetime=2020-08-24T11:05:17-05:00>24 August, 2020</time> by <a href=https://www.joshkasuboski.com/ class="p-author h-card" rel=author>Josh Kasuboski</a> Â· 2min read</p></header><section class="content e-content margin-top-l"><p>I set up my Raspberry Pi cluster to be accessible from the internet without configuring a port-forward on my router.</p><h2 id=tailscale>Tailscale</h2><p><a href=https://tailscale.com/>Tailscale</a> will create a private network using <a href=https://www.wireguard.com/>Wireguard</a>. Wireguard isn't really that difficult to configure on its own, but you do have to manually generate and distribute keys. Tailscale will take care of that for you and they also have some <a href=https://tailscale.com/blog/how-nat-traversal-works/>fallbacks</a> for difficult networks. It doesn't look like any of my nodes are using a fallback option based on the dashboard.</p><p>Setting up Tailscale is as easy as installing it and running <code>tailscale up</code>. Until recently, this required you to login interactively. Tailscale now supports <a href=https://tailscale.com/kb/1068/acl-tags#pre-authenticated-keys>pre-authenticated</a> keys which means you can automate the setup.</p><h2 id=installing-on-raspberry-pis>Installing on Raspberry PIs</h2><p>I made <a href=https://github.com/kasuboski/tailscale-install>kasuboski/tailscale-install</a> to automate the installation and start of Tailscale on Raspberry PIs. I plan to expand it to work on more varied platforms in the future.</p><p>It's a <a href=https://pyinfra.com/>PyInfra deploy</a> that basically just adds the package and runs <code>tailscale up</code> with a key sourced from the environment. I was able to add my Raspberry Pi cluster to the network in around 5 minutes, using this.</p><h2 id=exposing-to-the-internet>Exposing to the internet</h2><p>My cluster ingress is now slightly different than described <a href=https://www.joshkasuboski.com/posts/home-k8s-raspberry-update/>here</a>. Traffic from the Linode now goes directly to the Kubernetes nodes on the port exposed by the nginx-ingress controller. This just removes the extra hop that was initially an internal haproxy running on a different Raspberry Pi.</p><figure><img src=tailscale-diagram.png alt="Network Diagram"></figure></section><footer class=margin-top-m><a class="permalink u-url text-decoration-none" href=https://www.joshkasuboski.com/posts/connect-home-cloud-tailscale/>ðŸ”—</a></footer></article><nav class="margin-top-l flex justify-content-space-around"><div></div><div class=show-s-up><a alt="Top of page" href=#>Top</a></div><div><a alt="Older article" href=https://www.joshkasuboski.com/posts/generate-resume-gh-actions/>Generate Your Resume with GitHub Actions &rarr;</a></div></nav></main><footer class="container max-width-l margin-top-xl"><div class="box-shadow-l padding-m"><div class="h-card flex align-content-center"><figure class=icon-xxl><img class=u-photo src=https://www.joshkasuboski.com/img/josh-scotland.jpg></figure><div class=margin-left-m><h3 class=display-title><a class="u-url p-name text-decoration-none" href=https://www.joshkasuboski.com/>Josh Kasuboski</a></h3><p>Living in Austin <img class=icon-xs alt=texas src=https://www.joshkasuboski.com/img/texas.png> from <img class=icon-xs alt=wisconsin src=https://www.joshkasuboski.com/img/wisconsin.png></p><p id=social><a rel=me class="u-url margin-right-xs" href=https://github.com/kasuboski><img class=icon-xs src=https://www.joshkasuboski.com/icons/github.svg></a>
<a class=margin-right-xs href=https://linkedin.com/kasuboski><img class=icon-xs src=https://www.joshkasuboski.com/icons/linkedin.svg></a>
<a href=mailto:josh.kasuboski@gmail.com class="u-email margin-right-xxs" rel=me><img class=icon-xs src=https://www.joshkasuboski.com/icons/envelope.svg alt=email></a>
<button class="button button-icon button-xs" style=background-color:transparent;padding:0;border:0 id=checkout-button-beermoney role=link type=button>
<img class=icon-xs src=https://www.joshkasuboski.com/icons/beer-money-icon.svg alt=beermoney></button></p></div></div></div></footer></div><script>(function(f,a,t,h,o,m){a[h]=a[h]||function(){(a[h].q=a[h].q||[]).push(arguments)};o=f.createElement('script'),m=f.getElementsByTagName('script')[0];o.async=1;o.src=t;o.id='fathom-script';m.parentNode.insertBefore(o,m)})(document,window,'https://fathom.joshcorp.co/tracker.js','fathom');fathom('set','siteId','XFQVM');fathom('trackPageview');</script><script src=https://js.stripe.com/v3></script><script>(function(){var DOMAIN='https://www.joshkasuboski.com/';var key='pk_live_51HJtKkASjDZJS9C9Ja9g6zTFbaTEdW7uCK2OTK1dq741RisoSBtSIac1QEMphVCEEkA7hTeuopkUsajAyWuyH7kT00cU4iVGfX';var price='price_1HJtUTASjDZJS9C90kJjztUq';var stripe=Stripe(key);var checkoutButton=document.getElementById('checkout-button-beermoney');checkoutButton.addEventListener('click',function(){stripe.redirectToCheckout({lineItems:[{price:price,quantity:1}],mode:'payment',successUrl:DOMAIN+'success',cancelUrl:DOMAIN+'canceled',}).then(function(result){if(result.error){var displayError=document.getElementById('error-message');displayError.textContent=result.error.message;}});});})();</script></body></html>