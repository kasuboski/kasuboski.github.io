<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Homelab Raspberry Pi Kubernetes Cluster | Josh Kasuboski</title><meta name=description content="Setting up a k3s cluster at home on Raspberry Pis"><meta name=author content><link rel=apple-touch-icon sizes=180x180 href=https://www.joshkasuboski.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://www.joshkasuboski.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://www.joshkasuboski.com/favicon-16x16.png><link rel=manifest href=https://www.joshkasuboski.com/site.webmanifest><link rel=mask-icon href=https://www.joshkasuboski.com/safari-pinned-tab.svg color=#00416a><meta name=msapplication-TileColor content="#00aba9"><meta name=theme-color content="#ffffff"><link rel=me href=mailto:josh.kasuboski@gmail.com><link rel=me href=https://github.com/kasuboski><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=microsub href=https://aperture.p3k.io/microsub/465><link rel=alternate type=application/rss+xml href=https://www.joshkasuboski.com/index.xml><link rel=stylesheet href=https://www.joshkasuboski.com/css/fonts.css><link rel=stylesheet href=https://www.joshkasuboski.com/css/style.css><meta name=viewport content="width=device-width,initial-scale=1"></head><body><div id=sitelogo><a class=glyph alt=Home href=https://www.joshkasuboski.com/><img src=https://www.joshkasuboski.com/images/site-logo.svg alt="Site Logo" height=64px width=64px></a></div><header><nav><div id=page-nav><div class=page-nav-item><a href=https://www.joshkasuboski.com/>Home</a></div><div class=page-nav-item><a href=/about/><span>About</span></a></div><div class=page-nav-item><a href=/now/><span>Now</span></a></div></div></nav></header><div id=content><article class=h-entry><header><h1 class="post-title p-name">Homelab Raspberry Pi Kubernetes Cluster</h1><p class=post-date>Posted on
<time class=dt-published datetime=2020-05-02T16:17:39-05:00>2 May, 2020 at 16:17 -0500</time> by <a href=https://www.joshkasuboski.com/ class="p-author h-card" rel=author>Josh Kasuboski</a></p></header><section class="content e-content"><p>A platform to deploy my self-hosted services onto with almost $0 recurring costs.</p><p>Previously, I was running a few things on a Raspberry Pi 3B+. Mainly, <a href=https://github.com/0xERR0R/blocky>Blocky</a> as an ad-blocking local dns cache and some adventures with <a href=https://www.home-assistant.io/>Home Assistant</a>. A Kubernetes cluster will enable me to easily set up new things and have proper monitoring as well.</p><h2 id=hardware-acquisition>Hardware Acquisition</h2><p>I bought 3 <a href=https://www.canakit.com/raspberry-pi-4-4gb.html>Raspberry Pi 4 4GB</a> boards from Canakit. I also bought a pack of 5 <a href=https://www.amazon.com/gp/product/B07NP96DX5>SD cards</a>. I got a <a href=https://www.amazon.com/gp/product/B01NAG3V8E>6 port usb charging station</a> and USB-A to USB-C <a href=https://www.amazon.com/gp/product/B01JRY0VE4>cables</a> to power them.</p><p>I have 3 spare ethernet ports on my router so I will be using that directly for now. In the future, I may get a switch for them to connect to.</p><h2 id=setup>Setup</h2><p>I'm planning to install Raspian Lite and use <a href=https://github.com/alexellis/k3sup>k3sup</a> to install k3s. I looked into using <a href=https://github.com/rancher/k3os>k3os</a> directly, but it seems it's still not the easiest for a Raspberry Pi <a href=https://github.com/rancher/k3os/issues/309>issue</a>.</p><p>I will try to manage the cluster in a <a href=https://www.weave.works/technologies/gitops/>GitOps</a> style. As such, I will disable installing the Traefik Ingress Controller and Service Load Balancer by default and instead install them separately (or choose a different option).</p><h2 id=networking>Networking</h2><p>I will start out with the default flannel with vxlan, but am considering the wireguard backend. I would like to be able to access some services in the cluster using something like <a href=https://tailscale.com/>Tailscale</a> as well.</p><p>This might involve running separate ingress controllers like <a href=https://medium.com/@carlosedp/multiple-traefik-ingresses-with-letsencrypt-https-certificates-on-kubernetes-b590550280cf>here</a>.</p><h2 id=monitoring>Monitoring</h2><p>I'm going to deploy the standard <code>kube-prometheus</code> set up with the Prometheus Operator using this <a href=https://github.com/carlosedp/cluster-monitoring>repo</a>. It has k3s specific settings.</p></section><footer><a class="permalink u-url" href=https://www.joshkasuboski.com/posts/home-k8s-raspberry-pi/>ðŸ”—</a></footer></article></div><div class=h-card><img class=u-photo src=https://www.joshkasuboski.com/img/josh-scotland.jpg><div class=card-content><h2 class=card-name><a class="p-name u-url" href=https://www.joshkasuboski.com/ rel=me>Josh Kasuboski</a></h2><p class=card-subhead><span class=p-locality>Austin</span>,
<span class=p-country-name>United States</span><br><a class=u-email href=mailto:josh.kasuboski@gmail.com>Email me</a></p></div><p class=p-note>Josh Kasuboski is currently interested in developer productivity. He works to make it easier for a developer to take code from laptop to production.</p></div><div id=footer><nav id=article-skip><div class=next><a alt="Newer article" href=https://www.joshkasuboski.com/posts/home-k8s-raspberry-update/>&larr; Newer</a></div><div class=top><a alt="Top of page" href=#>Top</a></div><div class=prev><a alt="Older article" href=https://www.joshkasuboski.com/posts/deploy-site-github-actions/>Older &rarr;</a></div></nav><aside id=social><div id=social-icons><div class=icon-24x24><a class=glyph alt="Email me" href=mailto:josh.kasuboski@gmail.com><img src=https://www.joshkasuboski.com/icons/envelope.svg height=24px width=24px></a></div><div class=icon-24x24><a class=glyph alt="GitHub profile" href=https://github.com/kasuboski><img src=https://www.joshkasuboski.com/icons/github.svg height=24px width=24px></a></div><div class=icon-24x24><a class=glyph alt="LinkedIn profile" href=https://www.linkedin.com/in/joshkasuboski><img src=https://www.joshkasuboski.com/icons/linkedin.svg height=24px width=24px></a></div></div></aside><p class=copyright>Copyright Â© 2020, Josh Kasuboski</p></div></body></html>