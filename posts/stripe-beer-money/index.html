<!doctype html><html lang=en-US><head><meta charset=utf-8><title>Accept Beer Money with Stripe - Sans Server | Josh Kasuboski</title>
<meta name=description content="Josh Kasuboski's personal site"><meta name=author content="Josh Kasuboski"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.joshkasuboski.com/img/josh-scotland-full.jpg"><meta name=twitter:title content="Accept Beer Money with Stripe - Sans Server"><meta name=twitter:description content="I wanted to explore Stripe Payments, but didnâ€™t want to mess with a server. You can see the result as the little beer can in the footer ðŸ˜‰."><meta property="og:url" content="https://www.joshkasuboski.com/posts/stripe-beer-money/"><meta property="og:site_name" content="Josh Kasuboski"><meta property="og:title" content="Accept Beer Money with Stripe - Sans Server"><meta property="og:description" content="I wanted to explore Stripe Payments, but didnâ€™t want to mess with a server. You can see the result as the little beer can in the footer ðŸ˜‰."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-15T10:51:52-05:00"><meta property="article:modified_time" content="2020-10-15T10:51:52-05:00"><meta property="og:image" content="https://www.joshkasuboski.com/img/josh-scotland-full.jpg"><link rel=me href=mailto:josh.kasuboski@gmail.com><link rel=me href=https://github.com/kasuboski><link data-proofer-ignore rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link data-proofer-ignore rel=microsub href=https://microsub.joshcorp.co/microsub><link rel=alternate type=application/rss+xml href=https://www.joshkasuboski.com/index.xml><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://unpkg.com/turretcss/dist/turretcss.min.css crossorigin=anonymous><style>@media only screen and (min-width:768px){:root{font-size:18px}}body{background-color:#faf9fa}pre{background-color:#d4f2e1}a{text-decoration-color:#5965f9}#site-header{box-shadow:0 4px 12px rgba(0,0,0,5%)}#intro{background-color:#e6e8fe}#social a{color:transparent;text-decoration:none}</style></head><body><div class=padding-bottom-s><header id=site-header><div class="container max-width-l flex-justify-center padding-vertical-xs"><h1 class=no-margin-bottom><a class="text-decoration-none flex align-items-center" href=https://www.joshkasuboski.com/><img alt="jk logo" class="icon-s margin-right-xs" src=https://www.joshkasuboski.com/images/jk-logo.svg><small>Josh Kasuboski</small></a></h1><nav class=nav-inline><ul><li><a href=/about/>About</a></li><li><a href=/now/>Now</a></li></ul></nav></div></header><main class="container max-width-l margin-top-l"><article class=h-entry><header><h1 class="display-title-xl no-margin-bottom post-title p-name">Accept Beer Money with Stripe - Sans Server</h1><p class="post-date no-margin-top">Posted on
<time class=dt-published datetime=2020-10-15T10:51:52-05:00>15 October, 2020
</time>by <a href=https://www.joshkasuboski.com/ class="p-author h-card" rel=author>Josh Kasuboski</a> Â· 3min read</p></header><section class="content e-content margin-top-l"><p>I wanted to explore Stripe Payments, but didn&rsquo;t want to mess with a server. You can see the result as the little beer can in the footer ðŸ˜‰.</p><h2 id=how-it-works>How It Works</h2><p>Stripe has a Checkout option where you redirect to their page and it has your product and a payment form. This means you don&rsquo;t have to deal with <a href=https://www.pcisecuritystandards.org/>PCI</a> anything and basically just have to redirect correctly. They have a library to handle the redirect as well, so it&rsquo;s fairly easy.</p><p>You need to place a button that when clicked calls the Stripe Javascript library. Since I&rsquo;m &ldquo;selling&rdquo; beer money, I put a little beer can in my site footer.</p><p><img src=footer-beercan.png alt=footer-beercan></p><h2 id=adding-to-your-site>Adding to Your Site</h2><p>I followed this <a href=https://stripe.com/docs/payments/checkout/client>guide</a> from Stripe. It was a little difficult to find navigating the Stripe Docs, but searching Stripe Checkout without server brought me there.</p><p>I won&rsquo;t reiterate the guide, but basically you use the Stripe Dashboard to make a Product that has a Price. That price will then have an ID that you need. The dashboard will also generate the code snippet with the price ID and your API ID filled in. My edited snippet is below.</p><p>You&rsquo;ll notice it also expects a success and cancel URL. I added two pages that just say success, and uh oh respectively.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://js.stripe.com/v3&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>DOMAIN</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://www.joshkasuboski.com/&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;pk_livekey&gt;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>price</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;price_key&gt;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>stripe</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Stripe</span>(<span style=color:#a6e22e>key</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>checkoutButton</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;checkout-button-beermoney&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>checkoutButton</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;click&#39;</span>, <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// When the customer clicks on the button, redirect
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// them to Checkout.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>stripe</span>.<span style=color:#a6e22e>redirectToCheckout</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>lineItems</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>price</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>price</span>, <span style=color:#a6e22e>quantity</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> }],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;payment&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Do not rely on the redirect to the successUrl for fulfilling
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// purchases, customers may not always reach the success_url after
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// a successful payment.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// Instead use one of the strategies described in
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// https://stripe.com/docs/payments/checkout/fulfillment
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>successUrl</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>DOMAIN</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;success&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>cancelUrl</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>DOMAIN</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;canceled&#39;</span>,
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>result</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// If `redirectToCheckout` fails due to a browser or network
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#75715e>// error, display the localized error message to your customer.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>displayError</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;error-message&#39;</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>displayError</span>.<span style=color:#a6e22e>textContent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span>;
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  })();
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>That snippet and the button were all that I needed. Stripe will also provide testing keys for both price and API. So you can test with that first to make sure it is working.</p><p>After I set that up, I can click my beer can and end up at a page like below.</p><p><img src=beermoney-checkout.png alt="beer can checkout"></p><p>ðŸ’°ðŸ’°ðŸ’° <strong>Profit</strong> ðŸ’°ðŸ’°ðŸ’°</p><h2 id=other-cases>Other Cases</h2><p>This works pretty well if someone would only buy one item at a time. You could probably make a cart entirely on the frontend, keeping track of items a user wants and then when a user clicks <code>checkout</code>, you would send multiple <code>lineItems</code> in the Stripe Redirect.</p><p>This may not be good enough for a real store, but it&rsquo;s pretty convenient to have a fully client-side storefront.</p></section><footer class=margin-top-m><a class="permalink u-url text-decoration-none" href=https://www.joshkasuboski.com/posts/stripe-beer-money/>ðŸ”—</a></footer></article><nav class="margin-top-l flex justify-content-space-around"><div><a alt="Newer article" href=https://www.joshkasuboski.com/posts/trivy-gitops-repo-scan/>&larr; Scan Images in my GitOps Repo</a></div><div class=show-s-up><a data-proofer-ignore alt="Top of page" href=#>Top</a></div><div><a alt="Older article" href=https://www.joshkasuboski.com/posts/htmltest-githubactions/>Test HTML in GitHub Actions &rarr;</a></div></nav></main><footer class="container max-width-l margin-top-xl"><div class=margin-bottom-m><h4>Get more of my thoughts in an email newsletter!</h4><form action=https://buttondown.email/api/emails/embed-subscribe/kasuboski method=post target=popupwindow onsubmit='window.open("https://buttondown.email/kasuboski","popupwindow")' class=embeddable-buttondown-form><label for=bd-email>Your Email</label>
<input type=email name=email id=bd-email placeholder=me@email.com></input>
<input type=hidden value=1 name=embed></input>
<button class="button button-primary button-border" type=submit value=Subscribe>Subscribe</button><p class=font-size-s><a href=https://buttondown.email target=_blank>Powered by Buttondown.</a></p></form></div><div class="box-shadow-l padding-m"><div class="h-card flex align-content-center"><figure class=icon-xxl><img alt="profile photo" class=u-photo src=https://www.joshkasuboski.com/img/josh-scotland.jpg></figure><div class=margin-left-m><h3 class=display-title><a class="u-url p-name text-decoration-none" href=https://www.joshkasuboski.com/>Josh Kasuboski</a></h3><p>Living in Austin <img class=icon-xs style=vertical-align:middle alt=texas src=https://www.joshkasuboski.com/img/tx-fill.png> from <img class=icon-xs style=vertical-align:middle alt=wisconsin src=https://www.joshkasuboski.com/img/wi-fill.png></p><p id=social><a rel=me class="u-url margin-right-xs" href=https://github.com/kasuboski><img class=icon-xs src=https://www.joshkasuboski.com/icons/github.svg alt=github>
</a><a class=margin-right-xs href=https://linkedin.com/in/joshkasuboski/><img class=icon-xs src=https://www.joshkasuboski.com/icons/linkedin.svg alt=linkedin>
</a><a href=mailto:josh.kasuboski@gmail.com class="u-email margin-right-xxs" rel=me><img class=icon-xs src=https://www.joshkasuboski.com/icons/envelope.svg alt=email>
</a><a href=https://www.joshkasuboski.com/payments/><img class=icon-xs src=https://www.joshkasuboski.com/icons/beer-money-icon.svg alt=beermoney></a></p></div></div></div></footer></div><script async src=https://rum.cronitor.io/script.js></script><script>window.cronitor=window.cronitor||function(){(window.cronitor.q=window.cronitor.q||[]).push(arguments)},cronitor("config",{clientKey:"b2a9cb0f440d559169438f89c882dddb"})</script></body></html>